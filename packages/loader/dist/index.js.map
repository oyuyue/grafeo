{"version":3,"sources":["webpack://@grafeo/loader/./index.js"],"names":["global","self","hasDocument","document","ENTRY","SystemJS","this","registry","urlMap","systemJSPrototype","prototype","processScripts","forEach","call","querySelectorAll","script","sp","type","set","JSON","parse","innerHTML","imports","resolve","name","lastRegister","firstRegister","getOrCreateLoad","loader","id","load","importerSetters","ns","Object","create","instantiatePromise","Promise","then","getRegister","instantiate","registration","Error","declared","value","h","changed","p","__esModule","i","length","setter","import","importId","undefined","e","execute","setters","linkPromise","instantiation","all","map","dep","depId","depLoad","I","push","n","depLoads","d","catch","err","er","L","E","C","instantiateAll","loaded","register","deps","declare","field","loadId","postOrderExec","topLevelLoad","m","default","loc","assign","importmap","_lastRegister","lastWindowErrorUrl","lastWindowError","nullContext","freeze","seen","depLoadPromises","depLoadPromise","doExec","execPromise","window","addEventListener","evt","filename","error","url","reject","createElement","async","indexOf","location","origin","crossOrigin","src","head","removeChild","appendChild","tmpRegister","firstNamedDefine","emptyInstantiation","unsupportedRequire","emptyFn","lastRegisterDeclare","requireExportsModule","createAMDRegister","amdDefineDeps","amdDefineExec","exports","module","depModules","splice","index","createSetter","amdExec","_export","__useDefault","amdResult","apply","idx","systemAmdRegister","arguments","getDepsAndExec","arg1","arg2","Array","addToRegisterRegistry","define","System","registerRegistry","_firstNamedDefine","_amdDefineDeps","depsAndExec","concat","amd"],"mappings":"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","file":"index.js","sourcesContent":["var global = typeof self !== 'undefined' ? self : global\nvar hasDocument = typeof document !== 'undefined'\nvar ENTRY = '__ENTRY'\n\nfunction SystemJS () {\n  this.registry = {};\n  this.urlMap = {};\n}\n\nvar systemJSPrototype = SystemJS.prototype;\n\nsystemJSPrototype.processScripts = function () {\n  [].forEach.call(document.querySelectorAll('script'), (script) => {\n    if (script.sp) return;\n    if (script.type === 'importmap') {\n      script.sp = true;\n      this.set(JSON.parse(script.innerHTML).imports)\n    }\n  })\n}\n\nsystemJSPrototype.resolve = function(name) {\n  return this.urlMap[name]\n}\n\nvar firstRegister = true;\nvar lastRegister;\nsystemJSPrototype.register = function (deps, declare, registry) {\n  if (registry) this.set(registry)\n  lastRegister = [deps, declare];\n\n  if (firstRegister) {\n    firstRegister = false;\n    this.import();\n  }\n};\n\nsystemJSPrototype.import = function (id, field) {\n  var loader = this;\n  this.processScripts();\n  var loadId;\n  return Promise.resolve().then(function () {\n    var load = getOrCreateLoad(loader, loader.resolve(id) || id);\n    loadId = load.id;\n    return load.C || topLevelLoad(loader, load);\n  }).then(m => {\n    if (field === false) return m;\n    m = m.default\n    if (!m) return m;\n    return Promise.resolve(m).then(m => {\n      if (loadId === ENTRY && typeof m === 'function') return m(undefined, true)\n      if (typeof field === 'string') return m[field]\n      return m.default\n    })\n  })\n};\n\nsystemJSPrototype.set = function(name, loc) {\n  if (typeof name === 'object') {\n    Object.assign(this.urlMap, name)\n  } else if (typeof name === 'string') {\n    this.urlMap[name] = loc;\n  }\n}\n\nsystemJSPrototype.importmap = function() {\n  return this.urlMap\n}\n\n/*\n * getRegister provides the last anonymous System.register call\n */\nsystemJSPrototype.getRegister = function () {\n  var _lastRegister = lastRegister;\n  lastRegister = undefined;\n  return _lastRegister;\n};\n\nfunction getOrCreateLoad(loader, id = ENTRY) {\n  var load = loader.registry[id];\n  if (load) return load;\n\n  var importerSetters = [];\n  var ns = Object.create(null);\n\n  var instantiatePromise = Promise.resolve()\n  .then(function () {\n    if (id === ENTRY) return loader.getRegister();\n    return loader.instantiate(id);\n  })\n  .then(function (registration) {\n    if (!registration) throw Error('no registration');\n    function _export (name, value) {\n      // note if we have hoisted exports (including reexports)\n      load.h = true;\n      var changed = false;\n      if (typeof name === 'string') {\n        if (!(name in ns) || ns[name] !== value) {\n          ns[name] = value;\n          changed = true;\n        }\n      }\n      else {\n        for (var p in name) {\n          var value = name[p];\n          if (!(p in ns) || ns[p] !== value) {\n            ns[p] = value;\n            changed = true;\n          }\n        }\n\n        ns.__esModule = true;\n      }\n      if (changed)\n        for (var i = 0; i < importerSetters.length; i++) {\n          var setter = importerSetters[i];\n          if (setter) setter(ns);\n        }\n      return value;\n    }\n    var declared = registration[1](_export, registration[1].length === 2 ? {\n      import: function (importId) {\n        return loader.import(importId, id);\n      }\n    } : undefined);\n    load.e = declared.execute || function () {};\n    return [registration[0], declared.setters || []];\n  });\n\n  var linkPromise = instantiatePromise\n  .then(function (instantiation) {\n    return Promise.all(instantiation[0].map(function (dep, i) {\n      var setter = instantiation[1][i];\n      return Promise.resolve(loader.resolve(dep) || dep)\n      .then(function (depId) {\n        var depLoad = getOrCreateLoad(loader, depId);\n        // depLoad.I may be undefined for already-evaluated\n        return Promise.resolve(depLoad.I)\n        .then(function () {\n          if (setter) {\n            depLoad.i.push(setter);\n            // only run early setters when there are hoisted exports of that module\n            // the timing works here as pending hoisted export calls will trigger through importerSetters\n            if (depLoad.h || !depLoad.I) setter(depLoad.n);\n          }\n          return depLoad;\n        });\n      })\n    }))\n    .then(\n      function (depLoads) {\n        load.d = depLoads;\n      },\n      !true \n    )\n  });\n\n  linkPromise.catch(function (err) {\n    load.e = null;\n    load.er = err;\n  });\n\n  // Capital letter = a promise function\n  return load = loader.registry[id] = {\n    id: id,\n    // importerSetters, the setters functions registered to this dependency\n    // we retain this to add more later\n    i: importerSetters,\n    // module namespace object\n    n: ns,\n\n    // instantiate\n    I: instantiatePromise,\n    // link\n    L: linkPromise,\n    // whether it has hoisted exports\n    h: false,\n\n    // On instantiate completion we have populated:\n    // dependency load records\n    d: undefined,\n    // execution function\n    // set to NULL immediately after execution (or on any failure) to indicate execution has happened\n    // in such a case, C should be used, and E, I, L will be emptied\n    e: undefined,\n\n    // On execution we have populated:\n    // the execution error if any\n    er: undefined,\n    // in the case of TLA, the execution promise\n    E: undefined,\n\n    // On execution, L, I, E cleared\n\n    // Promise for top-level completion\n    C: undefined\n  };\n}\n\nfunction instantiateAll (loader, load, loaded) {\n  if (!loaded[load.id]) {\n    loaded[load.id] = true;\n    // load.L may be undefined for already-instantiated\n    return Promise.resolve(load.L)\n    .then(function () {\n      return Promise.all(load.d.map(function (dep) {\n        return instantiateAll(loader, dep, loaded);\n      }));\n    })\n  }\n}\n\nfunction topLevelLoad (loader, load) {\n  return load.C = instantiateAll(loader, load, {})\n  .then(function () {\n    return postOrderExec(loader, load, {});\n  })\n  .then(function () {\n    return load.n;\n  });\n}\n\n// the closest we can get to call(undefined)\nvar nullContext = Object.freeze(Object.create(null));\n\n// returns a promise if and only if a top-level await subgraph\n// throws on sync errors\nfunction postOrderExec (loader, load, seen) {\n  if (seen[load.id])\n    return;\n  seen[load.id] = true;\n\n  if (!load.e) {\n    if (load.er)\n      throw load.er;\n    if (load.E)\n      return load.E;\n    return;\n  }\n\n  // deps execute first, unless circular\n  var depLoadPromises;\n  load.d.forEach(function (depLoad) {\n      try {\n        var depLoadPromise = postOrderExec(loader, depLoad, seen);\n        if (depLoadPromise) \n          (depLoadPromises = depLoadPromises || []).push(depLoadPromise);\n      }\n      catch (err) {\n        load.e = null;\n        load.er = err;\n        throw err;\n      }\n  });\n  if (depLoadPromises)\n    return Promise.all(depLoadPromises).then(doExec, function (err) {\n      load.e = null;\n      load.er = err;\n      throw err;\n    });\n\n  return doExec();\n\n  function doExec () {\n    try {\n      var execPromise = load.e.call(nullContext);\n      if (execPromise) {\n          execPromise = execPromise.then(function () {\n            load.C = load.n;\n            load.E = null; // indicates completion\n            if (!true) ;\n          }, function (err) {\n            load.er = err;\n            load.E = null;\n            if (!true) ;\n            else throw err;\n          });\n        return load.E = load.E || execPromise;\n      }\n      // (should be a promise, but a minify optimization to leave out Promise.resolve)\n      load.C = load.n;\n      if (!true) ;\n    }\n    catch (err) {\n      load.er = err;\n      throw err;\n    }\n    finally {\n      load.L = load.I = undefined;\n      load.e = null;\n    }\n  }\n}\n\n/*\n * Script instantiation loading\n */\nvar lastWindowErrorUrl, lastWindowError;\nif (hasDocument) {\n  window.addEventListener('error', function (evt) {\n    lastWindowErrorUrl = evt.filename;\n    lastWindowError = evt.error;\n  });\n}\n\nsystemJSPrototype.instantiate = function (url) {\n  var loader = this;\n  return new Promise(function (resolve, reject) {\n    const script = document.createElement('script');\n    script.async = true;\n    if (url.indexOf(location.origin)) script.crossOrigin = 'anonymous';\n    script.src = url;\n    script.addEventListener('error', () => {\n      document.head.removeChild(script);\n      reject()\n    })\n    script.addEventListener('load', () => {\n      document.head.removeChild(script);\n      // Note that if an error occurs that isn't caught by this if statement,\n      // that getRegister will return null and a \"did not instantiate\" error will be thrown.\n      if (lastWindowErrorUrl === url) {\n        reject(lastWindowError);\n      }\n      else {\n        resolve(loader.getRegister());\n      }\n    })\n    document.head.appendChild(script);\n  });\n};\n\n\n\n// AMD\n\nvar emptyInstantiation = [[], function () { return {} }];\n\nfunction unsupportedRequire () {\n  throw Error('AMD require not supported');\n}\n\nvar tmpRegister, firstNamedDefine;\n\nfunction emptyFn () {}\n\nvar requireExportsModule = ['require', 'exports', 'module'];\n\nfunction createAMDRegister (amdDefineDeps, amdDefineExec) {\n  var exports = {};\n  var module = { exports: exports };\n  var depModules = [];\n  var setters = [];\n  var splice = 0;\n  for (var i = 0; i < amdDefineDeps.length; i++) {\n    var id = amdDefineDeps[i];\n    var index = setters.length;\n    if (id === 'require') {\n      depModules[i] = unsupportedRequire;\n      splice++;\n    }\n    else if (id === 'module') {\n      depModules[i] = module;\n      splice++;\n    }\n    else if (id === 'exports') {\n      depModules[i] = exports;\n      splice++;\n    }\n    else {\n      createSetter(i);\n    }\n    if (splice)\n      amdDefineDeps[index] = id;\n  }\n  if (splice)\n    amdDefineDeps.length -= splice;\n  var amdExec = amdDefineExec;\n  return [amdDefineDeps, function (_export) {\n    _export({ default: exports, __useDefault: true });\n    return {\n      setters: setters,\n      execute: function () {\n        var amdResult = amdExec.apply(exports, depModules);\n        if (amdResult !== undefined) module.exports = amdResult;\n        _export(module.exports);\n        _export('default', module.exports);\n      }\n    };\n  }];\n\n  // needed to avoid iteration scope issues\n  function createSetter(idx) {\n    setters.push(function (ns) {\n      depModules[idx] = ns.__useDefault ? ns.default : ns;\n    });\n  }\n}\n\n// hook System.register to know the last declaration binding\nvar lastRegisterDeclare;\nvar systemAmdRegister = systemJSPrototype.register;\nsystemJSPrototype.register = function (name, deps, declare) {\n  lastRegisterDeclare = typeof name === 'string' ? declare : deps;\n  systemAmdRegister.apply(this, arguments);\n};\n\nvar instantiate = systemJSPrototype.instantiate;\nsystemJSPrototype.instantiate = function() {\n  // Reset \"currently executing script\"\n  amdDefineDeps = null;\n  return instantiate.apply(this, arguments);\n};\n\nvar getRegister = systemJSPrototype.getRegister;\nsystemJSPrototype.getRegister = function () {\n  if (tmpRegister)\n    return tmpRegister;\n\n  var _firstNamedDefine = firstNamedDefine;\n  firstNamedDefine = null;\n\n  var register = getRegister.call(this);\n  // if its an actual System.register leave it\n  if (register && register[1] === lastRegisterDeclare)\n    return register;\n\n  var _amdDefineDeps = amdDefineDeps;\n  amdDefineDeps = null;\n\n  // If the script registered a named module, return that module instead of re-instantiating it.\n  if (_firstNamedDefine)\n    return _firstNamedDefine;\n\n  // otherwise AMD takes priority\n  // no registration -> attempt AMD detection\n  if (!_amdDefineDeps)\n    return register || emptyInstantiation;\n\n  return createAMDRegister(_amdDefineDeps, amdDefineExec);\n};\nvar amdDefineDeps, amdDefineExec;\nglobal.define = function (name, deps, execute) {\n  var depsAndExec;\n  // define('', [], function () {})\n  if (typeof name === 'string') {\n    depsAndExec = getDepsAndExec(deps, execute);\n    if (amdDefineDeps) {\n      if (!System.registerRegistry) {\n        throw Error('Include the named register extension for SystemJS named AMD support');\n      }\n      addToRegisterRegistry(name, createAMDRegister(depsAndExec[0], depsAndExec[1]));\n      amdDefineDeps = [];\n      amdDefineExec = emptyFn;\n      return;\n    }\n    else {\n      if (System.registerRegistry)\n        addToRegisterRegistry(name, createAMDRegister([].concat(depsAndExec[0]), depsAndExec[1]));\n      name = deps;\n      deps = execute;\n    }\n  }\n  depsAndExec = getDepsAndExec(name, deps);\n  amdDefineDeps = depsAndExec[0];\n  amdDefineExec = depsAndExec[1];\n};\nglobal.define.amd = {};\n\nfunction getDepsAndExec(arg1, arg2) {\n  // define([], function () {})\n  if (arg1 instanceof Array) {\n    return [arg1, arg2];\n  }\n  // define({})\n  else if (typeof arg1 === 'object') {\n    return [[], function () { return arg1 }];\n  }\n  // define(function () {})\n  else if (typeof arg1 === 'function') {\n    return [requireExportsModule, arg1];\n  }\n}\n\nfunction addToRegisterRegistry(name, define) {\n  if (!firstNamedDefine) {\n    firstNamedDefine = define;\n    Promise.resolve().then(function () {\n      firstNamedDefine = null;\n    });\n  }\n\n  // We must call System.getRegister() here to give other extras, such as the named-exports extra,\n  // a chance to modify the define before it's put into the registerRegistry.\n  // See https://github.com/systemjs/systemjs/issues/2073\n  tmpRegister = define;\n  System.registerRegistry[name] = System.getRegister();\n  tmpRegister = null;\n}\n\nglobal.System = new SystemJS()\n"],"sourceRoot":""}